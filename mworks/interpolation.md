
# Interpolation

## Linear Interpolation

$$
\begin{aligned}
  y = y_1 + \frac{x - x_1}{x_2 - x_1} \cdot (y_2 - y_1)
\end{aligned}
$$

## Lagrange’s Interpolation

$$
\begin{aligned}
  y &= \sum_{i=0}^{n} \frac{\prod_{q\neq i, q=0}^{n} x - x_q}{\prod_{p\neq i, p=0}^{n} x_i - x_p} \cdot y_i \\
  &= \sum_{i=0}^{n} \prod_{j=0, j \neq i}^{n} \frac{x - x_j}{x_i - x_j}
\end{aligned}
$$

![IMG_2258](https://github.com/user-attachments/assets/035dcc95-b0d9-41da-aa07-cf8398f2620e)

Note that the function that Lagrange’s interpolation construct is actually a polymorphic functions.

### Another Expression

TODO

### Error Estimate

For a $n$-degree Lagrange’s Interpolation formula(Generated by $n+1$ points), it’s error could be expressed as:

$$
\begin{aligned}
  R_{n} &= \frac{M_{n+1}}{(n+1)!}\cdot|\omega_{n+1}(x)| \\
  &= \frac{f^{n+1}(\xi)}{(n+1)!}\cdot|\prod_{i=0}^{i=n}(x-x_i)|
\end{aligned}
$$

In which:

- $M_{n+1}$: Is the $n+1$-th derivative of original function $f(x)$
- $\omega_{n+1}(x) = \prod_{i=0}^{n}(x - x_i)$

Generally, we don’t know the value of $M_{n+1}(x)$, but if the $f(x)$ is special enough, then we may know it’s maximum.

E.g., if $f(x) = \sin x$, then $M_{2}(x)$ has the maximum value of $1$.

This is helpful when we want to **limit the maximum rest error**. Check out the example question below:

![1D717070C59C83E1434B6582E9AC780D](https://github.com/user-attachments/assets/32da2da4-8754-4c95-92f6-585f1b8c3a2d)


## Newton Interpolation

$$
f(x)=a_0+a_1(x−x_0)+a_2(x−x_0)(x−x_1)+\cdots+a_n(x−x_0)(x−x_1)\cdots(x−x_n)
$$

If we let: $n_i(x) = \prod_{j=0}^{i-1}(x - x_j)$ (specially, we have $n_0(x) = 1$), then:

$$
f(x) = \sum_{i=0}^{n} (a_i \cdot n_i)
$$

The advantage is that the value of **all previous $a$ is identical when we adding a new point**.

### Divided Differences

The calculation of coefficients could be defined recursively using **Divided Differences**.

First, obviously we could have $a_0 = y_0$, then:

$$
\begin{aligned}
a_1 &= [y_0, y_1] &=& \frac{y_1 - y_0}{x_1 - x_0} \\
a_2 &= [y_0, y_1, y_2] &=& \frac{[y_2 - y_1] - [y_1 - y_0]}{x_2 - x_0} \\
a_3 &= [y_0, y_1, y_2, y_3] &=& \frac{[y_3 - y_2 - y_1] - [y_2 - y_1 - y_0]}{x_3 - x_0} \\
&& \cdots
\end{aligned}
$$

We could use a table to quickly calculate all values needed in the formula above:

![image](https://github.com/user-attachments/assets/b3044fa4-a9e0-4b14-847a-8e2665d2b7d1)

Below is an example:

![image](https://github.com/user-attachments/assets/0c6cedc9-a0e8-42e4-89d4-796665455107)


### Order Of Points

The points in DD(Divided Difference) table could be exchanged.

![IMG_3933](https://github.com/user-attachments/assets/5632d57c-e96c-41e7-8920-e7484becc6d1)


Consider the example question above. If we use the x-coordinate sequence $[1,2,4,5]$, then when estimate point $x=2.4$ with power 1 (only using 2 points), we are actually doing extrapolation ($2.4 \notin [1,2]$)

So to make we are doing interpolation, we could put the point $(2,6), \; (4,2)$ at the beginning.

### Rest Of Newton Interpolation

For an order-$n$ newton interpolation and an estimate $y_e = f(x_e)$, it’s easy to calculate the $R$ (which is the error value between estimate $y_e$ and the true $y$ if there is one)

We just consider that we have a new point $(x_e, y_t)$ ($y_t = f(x_e)$, which is the true $y$ value of the function), then calculate the order-$n+1$ coefficient: 

$$f[x_0, x_1, …, x_n, x]$$

And we use this coefficient and the original interpolation $N_n(x)$ to construct a new Newton Interpolation with order $n+1$:

$$
N_{n+1}(x) = N_{n}(x) + f[x_0, x_1, …, x_n, x_e]\omega_{n+1}(x)
$$

> The definition of $\omega{n}$, check out the chapter of Rest of Lagrange’s Interpolation.

And we also know the the the point $(x_e, y_t)$ is a sample point, so $N_{n+1}(x_e)$ must precisely on the interpolation function. So we have:

$$
f(x_e) = N_{n}(x_e) + f[x_0, x_1, …, x_n, x_e]\omega_{n+1}(x_e)
$$

At this point, we will found that for a certain point $x_e$, the error between estimate and true value (that is, the rest), is exactly:

$$
f[x_0, x_1, …, x_n, x_e]\omega_{n+1}(x_e)
$$

So in conclusion, for a $n$ order Newton Interpolation $N_n(x)$, it's rest at position $x$ is:

$$
R_{n} = f[x_0, x_1, …, x_n, x]\omega_{n+1}(x)
$$

## Hermite Interpolation

Similar to Lagrange, however, allow limiting derivative value at some points.

The **order is determined by the total number of conditions** (including value condition and derivative condition)

### Construction Example

![image](https://github.com/user-attachments/assets/0de4d03c-26fe-403a-9acf-4e17b2b7eff2)

As we see, there are 4 total conditions, so the max order should be set to $3$. Also, we list out the function value of $\alpha$ based on conditions (see the image above).

After the equation construction, we need to solve out the value of $\alpha_i, i \in \{1,2,3,4\}$. Here note that $\alpha$ is not a number, it's a $n$ order polynomial with variable $x$.

![image](https://github.com/user-attachments/assets/f06e005c-ebdb-4691-9040-b1ccf9637d5e)

### About Factor Theorem

![image](https://github.com/user-attachments/assets/cad9a9b9-d38d-43fc-b3e8-710338aaa182)


## Spline Interpolation

Devided the $n+1$ points into $n$ segments. Each segments interpolation will be an $3$-order function.

### Conditions Used

![Conditions](https://github.com/user-attachments/assets/4660a65b-5571-4504-b22e-e5793fd55ab7)

Then we could use different additional conditions as shown follows:

![Edge Conditions](https://github.com/user-attachments/assets/68ab2199-611a-4a12-afd6-a814b57fa985)


### Error Estimate

\fr![Spline Error Estimate](https://github.com/user-attachments/assets/dd594034-677b-4637-b417-49fc6fb0293a)

Notice for a Hermite 2-point 3-order interpolation, the error is $\frac{h^4}{384}|f^{(4)}|$. That’is, value error of Spline is 5 times larger than 2p3o hermite interpolation.

## Refs

- [Construction Intuition Of Lagrange’s Formula](https://www.cnblogs.com/olderciyuan/p/15578688.html)
- [Lagrange’s Error Estimation](https://blog.csdn.net/yuanYW7556/article/details/102974768)
- [Another Approach To Calc Hermite Coefficient](https://coast.nd.edu/jjwteach/www/www/30125/pdfnotes/lecture5_9v14.pdf)
