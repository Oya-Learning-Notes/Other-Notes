# Interpolation

## Linear Interpolation

$$
\begin{aligned}
  y = y_1 + \frac{x - x_1}{x_2 - x_1} \cdot (y_2 - y_1)
\end{aligned}
$$

## Lagrange’s Interpolation

$$
\begin{aligned}
  y &= \sum_{i=0}^{n} \frac{\prod_{q\neq i, q=0}^{n} x - x_q}{\prod_{p\neq i, p=0}^{n} x_i - x_p} \cdot y_i \\
  &= \sum_{i=0}^{n} \prod_{j=0, j \neq i}^{n} \frac{x - x_j}{x_i - x_j}
\end{aligned}
$$

![IMG_2258](https://github.com/user-attachments/assets/035dcc95-b0d9-41da-aa07-cf8398f2620e)

Note that the function that Lagrange’s interpolation construct is actually a polymorphic functions.

### Another Expression

TODO

### Error Estimate

For a $n$-degree Lagrange’s Interpolation formula(Generated by $n+1$ points), it’s error could be expressed as:

$$
\begin{aligned}
  R_{n} &= \frac{M_{n+1}}{(n+1)!}\cdot|\omega_{n+1}(x)| \\
  &= \frac{f^{n+1}(\xi)}{(n+1)!}\cdot|\prod_{i=0}^{i=n}(x-x_i)|
\end{aligned}
$$

In which:

- $M_{n+1}$: Is the $n+1$-th derivative of original function $f(x)$
- $\omega_{n+1}(x) = \prod_{i=0}^{n}(x - x_i)$

Generally, we don’t know the value of $M_{n+1}(x)$, but if the $f(x)$ is special enough, then we may know it’s maximum.

E.g., if $f(x) = \sin x$, then $M_{2}(x)$ has the maximum value of $1$.

This is helpful when we want to **limit the maximum rest error**. Check out the example question below:

![1D717070C59C83E1434B6582E9AC780D](https://github.com/user-attachments/assets/32da2da4-8754-4c95-92f6-585f1b8c3a2d)


## Newton Interpolation

$$
f(x)=a_0+a_1(x−x_0)+a_2(x−x_0)(x−x_1)+\cdots+a_n(x−x_0)(x−x_1)\cdots(x−x_n)
$$

If we let: $n_i(x) = \prod_{j=0}^{i-1}(x - x_j)$ (specially, we have $n_0(x) = 1$), then:

$$
f(x) = \sum_{i=0}^{n} (a_i \cdot n_i)
$$

The advantage is that the value of **all previous $a$ is identical when we adding a new point**.

## Divided Differences

The calculation of coefficients could be defined recursively using **Divided Differences**.

First, obviously we could have $a_0 = y_0$, then:

$$
\begin{aligned}
a_1 &= [y_0, y_1] &=& \frac{y_1 - y_0}{x_1 - x_0} \\
a_2 &= [y_0, y_1, y_2] &=& \frac{[y_2 - y_1] - [y_1 - y_0]}{x_2 - x_0} \\
a_3 &= [y_0, y_1, y_2, y_3] &=& \frac{[y_3 - y_2 - y_1] - [y_2 - y_1 - y_0]}{x_3 - x_0} \\
&& \cdots
\end{aligned}
$$

We could use a table to quickly calculate all values needed in the formula above:

![image](https://github.com/user-attachments/assets/b3044fa4-a9e0-4b14-847a-8e2665d2b7d1)

Below is an example:

![image](https://github.com/user-attachments/assets/0c6cedc9-a0e8-42e4-89d4-796665455107)


## Refs

- [Construction Intuition Of Lagrange’s Formula](https://www.cnblogs.com/olderciyuan/p/15578688.html)
- [Lagrange’s Error Estimation](https://blog.csdn.net/yuanYW7556/article/details/102974768)
